#!/bin/bash

. /.env

if [ -z "$tool_list" ]; then
  echo "No tools provided"
  exit 1
fi

if [ -z "$cves" ]; then
  echo "No CVEs provided"
  exit 1
fi

cmd=""

if [ $1 == "run" ]; then
  cmd="run"
elif [ $1 == "report" ]; then
  cmd="report --kind server"
else
  echo "Unknown command: \"$1\""
  exit 1
fi

if [ "$cves" == "*" ]; then
  echo "running \"node index $cmd $tool_list '*'\""
  node index $cmd $tool_list '*'
else
  echo "running \"node index $cmd $tool_list $cves\""
  node index $cmd $tool_list $cves
fi
